<h3 class="my-3">Home</h3>

<div class="form-group mb-3">
    <label for="currentFolderPath">Current Folder</label>
    <div class="input-group mb-2">
        <input type="text" class="form-control" id="currentFolderPath" [(ngModel)]="homeService.currentFolderPath"
            (change)="onChangeCurrentFolderPath()">
        <button class="btn btn-outline-secondary" type="button" (click)="onClickParentButton()" title="Parent Folder">
            <i class="bi bi-arrow-90deg-left"></i>
        </button>
        <button class="btn btn-outline-secondary" type="button" (click)="onClickHomeButton()" title="Home Folder">
            <i class="bi bi-house"></i>
        </button>
        <button class="btn btn-outline-secondary" type="button" (click)="onClickRefreshButton()" title="Refresh">
            <i class="bi bi-arrow-clockwise"></i>
        </button>
    </div>

    <div class="btn-group" role="group">
        <button class="btn btn-success" (click)="onClickFileOptionButton(false)" [disabled]="!homeService.allFiles"
            title="Show folders and files within the current folder">
            This Folder
        </button>
        <button class="btn btn-success" (click)="onClickFileOptionButton(true)" [disabled]="homeService.allFiles"
            title="Show all files inside the current folder">
            All Files
        </button>
    </div>
</div>

<div class="mb-3">
    <button class="btn btn-outline-primary mb-2" (click)="onClickSearchingButton()">
        {{ homeService.enableSearching ? 'Disable Searching' : 'Enable Searching' }}
    </button>
    <span class="mx-3" [hidden]="homeService.loading || homeService.errorMessage">
        {{ homeService.size }} folders and files
    </span>
    @if (homeService.enableSearching) {
    <div class="mb-2">
        <label for="searchingName">Search by name</label>
        <input type="text" class="form-control" id="searchingName" [(ngModel)]="homeService.searchingName"
            (input)="onInputSearchingName()">
    </div>
    <div class="mb-2">
        <label for="searchingTagsCheckBox">Search by tags</label>
        @if (homeService.searchingTags.length === 0) {
        <p class="mx-3">There is no any tags in this system.</p>
        } @else {
        <div>
            @for (searchingTag of homeService.searchingTags; track $index) {
            <button class="btn mx-1 rounded-pill"
                [ngClass]="{ 'btn-outline-secondary': !searchingTag.active, 'btn-secondary': searchingTag.active }"
                (click)="onClickSearchingTagButton(searchingTag)">
                {{ searchingTag.name }}
            </button>
            }
        </div>
        }
    </div>
    }
</div>

<div class="mb-3">
    @if (homeService.loading) {
    <p>Loading...</p>
    } @else if (homeService.errorMessage) {
    <div class="alert alert-danger d-flex align-items-center fade show">
        <i class="bi-exclamation-octagon-fill"></i>
        <strong class="mx-2">Error!</strong>{{ homeService.errorMessage }}
    </div>
    } @else {
    @if (homeService.totalPageNumber > 1) {
    <div class="container">
        <div class="row">
            <div class="col-md-2">
                <div class="input-group">
                    <span class="input-group-text">Page</span>
                    <input type="text" style="text-align: right;" class="form-control"
                        [(ngModel)]="homeService.currentPageNumber" (change)="onInputChangePage()">
                    <span class="input-group-text">/ {{ homeService.totalPageNumber }}</span>
                </div>
            </div>
            <div class="col-md-10 text-end">
                <button class="btn btn-outline-secondary mx-2"
                    [ngClass]="{ 'invisible': homeService.currentPageNumber === 1 }"
                    (click)="onClickChangePage(true)">Previous Page</button>
                <button class="btn btn-outline-secondary mx-2"
                    [ngClass]="{ 'invisible': homeService.currentPageNumber === homeService.totalPageNumber}"
                    (click)="onClickChangePage(false)">Next Page</button>
            </div>
        </div>
    </div>
    }
    <table class="table table-hover">
        <thead>
            <tr>
                <th style="width: 54%;" (click)="onClickTableHeader(0)">
                    Name ({{ homeService.desktopFiles1000.length }})
                    <i class="bi bi-caret-up-fill" [hidden]="homeService.sortingMode !== 0"></i>
                    <i class="bi bi-caret-down-fill" [hidden]="homeService.sortingMode !== 1"></i>
                </th>
                <th class="text-center" style="width: 15%;" (click)="onClickTableHeader(2)">
                    Last modified
                    <i class="bi bi-caret-up-fill" [hidden]="homeService.sortingMode !== 2"></i>
                    <i class="bi bi-caret-down-fill" [hidden]="homeService.sortingMode !== 3"></i>
                </th>
                <th class="text-center" style="width: 8%;" (click)="onClickTableHeader(4)">
                    Type
                    <i class="bi bi-caret-up-fill" [hidden]="homeService.sortingMode !== 4"></i>
                    <i class="bi bi-caret-down-fill" [hidden]="homeService.sortingMode !== 5"></i>
                </th>
                <th class="text-center" style="width: 10%;" (click)="onClickTableHeader(6)">
                    Size
                    <i class="bi bi-caret-up-fill" [hidden]="homeService.sortingMode !== 6"></i>
                    <i class="bi bi-caret-down-fill" [hidden]="homeService.sortingMode !== 7"></i>
                </th>
                <th class="text-center" style="width: 13%;">
                    Actions
                </th>
            </tr>
        </thead>
        <tbody>
            @for (desktopFile of homeService.desktopFiles1000; track $index) {
            <tr [ngClass]="{ 'table-light': desktopFile.isFolder }">
                <td title="{{ desktopFile.tags | tags }}" (click)="onClickTableElementName(desktopFile)">
                    {{ desktopFile.name }}
                </td>
                <td class="text-center">
                    {{ desktopFile.lastModified | lastModifiedDate }}
                </td>
                <td class="text-center">
                    {{ desktopFile.extension }}
                </td>
                <td class="text-end">
                    {{ desktopFile | byteSize }}
                </td>
                <td class="text-center">
                    @if (desktopFile.isFolder) {
                    <i class="bi bi-folder mx-2" title="Open folder"
                        (click)="onClickOpenFileButton(desktopFile.absolutePath)"></i>
                    } @else {
                    <i class="bi bi-file-earmark mx-2" title="Open file"
                        (click)="onClickOpenFileButton(desktopFile.absolutePath)"></i>
                    <i class="bi bi-folder mx-2" title="Show in folder"
                        (click)="onClickOpenFileButton(desktopFile.parentFolderPath)"></i>
                    <i class="bi bi-trash mx-2" title="Delete file" (click)="onClickDeleteFileButton(desktopFile)"></i>
                    <i class="bi bi-bookmark mx-2" title="File Details" (click)="onClickTagButton(desktopFile)"></i>
                    }
                </td>
            </tr>
            }
        </tbody>
    </table>
    @if (homeService.totalPageNumber > 1) {
    <div class="container">
        <div class="row">
            <div class="col-md-2">
                <div class="input-group">
                    <span class="input-group-text">Page</span>
                    <input type="text" style="text-align: right;" class="form-control"
                        [(ngModel)]="homeService.currentPageNumber" (change)="onInputChangePage()">
                    <span class="input-group-text">/ {{ homeService.totalPageNumber }}</span>
                </div>
            </div>
            <div class="col-md-10 text-end">
                <button class="btn btn-outline-secondary mx-2"
                    [ngClass]="{ 'invisible': homeService.currentPageNumber === 1 }"
                    (click)="onClickChangePage(true)">Previous Page</button>
                <button class="btn btn-outline-secondary mx-2"
                    [ngClass]="{ 'invisible': homeService.currentPageNumber === homeService.totalPageNumber}"
                    (click)="onClickChangePage(false)">Next Page</button>
            </div>
        </div>
    </div>
    }
    }
</div>